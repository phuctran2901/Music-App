{"ast":null,"code":"import _defineProperty from\"D:/music-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _slicedToArray from\"D:/music-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import React,{useState}from'react';import{storage,database}from'../../configFirebase';import{FaCloudUploadAlt}from'react-icons/fa';import{AiFillCloseCircle}from'react-icons/ai';import'./style.css';import{toast}from'react-toastify';import{IconContext}from'react-icons/lib';Uploadfiles.default={toggleFormUpload:false,handleUploadSong:null,handleToggleFormUpload:null};function Uploadfiles(props){var _useState=useState(null),_useState2=_slicedToArray(_useState,2),fileAudio=_useState2[0],setfileAudio=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),fileImage=_useState4[0],setfileImage=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),urlAudio=_useState6[0],setUrlAudio=_useState6[1];var _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),urlImage=_useState8[0],setUrlImage=_useState8[1];var _useState9=useState(null),_useState10=_slicedToArray(_useState9,2),progessAudio=_useState10[0],setProgessAudio=_useState10[1];var _useState11=useState(null),_useState12=_slicedToArray(_useState11,2),progessImage=_useState12[0],setProgessImage=_useState12[1];var _useState13=useState(''),_useState14=_slicedToArray(_useState13,2),artistName=_useState14[0],setAristName=_useState14[1];var _useState15=useState(''),_useState16=_slicedToArray(_useState15,2),audioName=_useState16[0],setAudioName=_useState16[1];var toggleFormUpload=props.toggleFormUpload,handleUploadSong=props.handleUploadSong,handleToggleFormUpload=props.handleToggleFormUpload;var handleChangeFiles=function handleChangeFiles(e){if(e.target.name===\"fileAudio\"){setfileAudio(e.target.files[0]);}if(e.target.name===\"fileImage\"){setfileImage(e.target.files[0]);}};var handleChangeText=function handleChangeText(e){if(e.target.name==='audioName'){setAudioName(e.target.value);}else{setAristName(e.target.value);}};var handleSaveAudio=function handleSaveAudio(){if(fileAudio){var uploadTask=storage.ref(\"Audios/\".concat(fileAudio.name)).put(fileAudio);uploadTask.on(\"state_changed\",function(snapshot){var progressBarAudio=Math.round(snapshot.bytesTransferred/snapshot.totalBytes*100);setProgessAudio(progressBarAudio);},function(error){console.log('err',error);},function(){storage.ref(\"Audios\").child(fileAudio.name).getDownloadURL().then(function(urlAudio){setUrlAudio(urlAudio);});});}else{toast('Chọn file bạn muốn up!',{position:\"top-left\",autoClose:4000,hideProgressBar:false,closeOnClick:true,pauseOnHover:true,draggable:true,progress:undefined});}};var handleSaveImage=function handleSaveImage(){if(fileImage){var uploadTask=storage.ref(\"Images/\".concat(fileImage.name)).put(fileImage);uploadTask.on(\"state_changed\",function(snapshot){var progressBarImage=Math.round(snapshot.bytesTransferred/snapshot.totalBytes*100);setProgessImage(progressBarImage);},function(error){console.log('err',error);},function(){storage.ref(\"Images\").child(fileImage.name).getDownloadURL().then(function(urlImage){setUrlImage(urlImage);});});}else{toast('Chọn file bạn muốn up!',{position:\"top-left\",autoClose:4000,hideProgressBar:false,closeOnClick:true,pauseOnHover:true,draggable:true,progress:undefined});}};var onUploadDatabase=function onUploadDatabase(){var databaseRef=database.ref('Audios');if(fileAudio&&fileImage){if(urlAudio&&urlImage){if(audioName&&artistName){databaseRef.push({src:urlAudio,image:urlImage,name:audioName,artist:artistName});handleUploadSong({src:urlAudio,image:urlImage,name:audioName,artist:artistName});toast.success('Upload bài hát thành công!',{position:\"top-left\",autoClose:4000,hideProgressBar:false,closeOnClick:true,pauseOnHover:true,draggable:true,progress:undefined});handleToggleFormUpload(false);// reset value\nsetAristName('');setAudioName('');setProgessAudio(0);setProgessImage(0);}else{toast('Vui lòng nhập thông tin bài hát!',{position:\"top-left\",autoClose:4000,hideProgressBar:false,closeOnClick:true,pauseOnHover:true,draggable:true,progress:undefined});}}else{toast('Tải file đã(hoặc chờ tải file)!',{position:\"top-left\",autoClose:4000,hideProgressBar:false,closeOnClick:true,pauseOnHover:true,draggable:true,progress:undefined});}}else{toast('Vui lòng up file!',{position:\"top-left\",autoClose:4000,hideProgressBar:false,closeOnClick:true,pauseOnHover:true,draggable:true,progress:undefined});}};var onToggleFormUpload=function onToggleFormUpload(){handleToggleFormUpload(false);};return/*#__PURE__*/_jsxs(\"div\",{className:\"form-upload \".concat(toggleFormUpload?'open':''),children:[/*#__PURE__*/_jsx(\"div\",{onClick:onToggleFormUpload,children:/*#__PURE__*/_jsx(IconContext.Provider,{value:{className:\"files-close\",size:30},children:/*#__PURE__*/_jsx(AiFillCloseCircle,{})})}),/*#__PURE__*/_jsx(\"p\",{className:\"files-title\",children:\"Upload Files\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"files-audio\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"files-name\",children:\"Audio\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",name:\"fileAudio\",accept:\".mp3\",className:\"files-input\",onChange:handleChangeFiles}),/*#__PURE__*/_jsx(\"button\",{className:\"files-button\",onClick:handleSaveAudio,children:/*#__PURE__*/_jsx(IconContext.Provider,{value:{size:20,color:'#ffffff'},children:/*#__PURE__*/_jsx(FaCloudUploadAlt,{})})}),/*#__PURE__*/_jsx(\"div\",{className:\"progress\",style:{height:'8px'},children:/*#__PURE__*/_jsx(\"div\",{className:\"progress-bar progress-bar-striped \",role:\"progressbar\",\"aria-valuemin\":\"0\",\"aria-valuemax\":\"100\",style:{width:\"\".concat(progessAudio,\"%\")}})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"files-image\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"files-name\",children:\"Image\"}),/*#__PURE__*/_jsx(\"input\",{accept:\".jpg\",type:\"file\",name:\"fileImage\",className:\"files-input\",onChange:handleChangeFiles}),/*#__PURE__*/_jsx(\"button\",{className:\"files-button\",onClick:handleSaveImage,children:/*#__PURE__*/_jsx(IconContext.Provider,{value:{size:20,color:'#ffffff'},children:/*#__PURE__*/_jsx(FaCloudUploadAlt,{})})}),/*#__PURE__*/_jsx(\"div\",{className:\"progress\",style:{height:'8px',Backgroundcolor:'#56184d'},children:/*#__PURE__*/_jsx(\"div\",_defineProperty({style:{backgroundColor:'#56184d'},className:\"progress-bar progress-bar-striped\",role:\"progressbar\",\"aria-valuemin\":\"0\",\"aria-valuemax\":\"100\"},\"style\",{width:\"\".concat(progessImage,\"%\")}))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"wrapper-upload\",children:[/*#__PURE__*/_jsx(\"input\",{placeholder:\"Artist Name\",name:\"artistName\",className:\"files-text\",value:artistName,onChange:handleChangeText,type:\"text\"}),/*#__PURE__*/_jsx(\"input\",{placeholder:\"Audio Name\",onChange:handleChangeText,name:\"audioName\",value:audioName,className:\"files-text\",type:\"text\"}),/*#__PURE__*/_jsx(\"button\",{className:\"files-button__upload\",onClick:onUploadDatabase,children:\"L\\u01B0u l\\u1EA1i\"})]})]});}export default Uploadfiles;","map":{"version":3,"sources":["D:/music-app/src/components/UploadFiles/index.jsx"],"names":["React","useState","storage","database","FaCloudUploadAlt","AiFillCloseCircle","toast","IconContext","Uploadfiles","default","toggleFormUpload","handleUploadSong","handleToggleFormUpload","props","fileAudio","setfileAudio","fileImage","setfileImage","urlAudio","setUrlAudio","urlImage","setUrlImage","progessAudio","setProgessAudio","progessImage","setProgessImage","artistName","setAristName","audioName","setAudioName","handleChangeFiles","e","target","name","files","handleChangeText","value","handleSaveAudio","uploadTask","ref","put","on","snapshot","progressBarAudio","Math","round","bytesTransferred","totalBytes","error","console","log","child","getDownloadURL","then","position","autoClose","hideProgressBar","closeOnClick","pauseOnHover","draggable","progress","undefined","handleSaveImage","progressBarImage","onUploadDatabase","databaseRef","push","src","image","artist","success","onToggleFormUpload","className","size","color","height","width","Backgroundcolor","backgroundColor"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { storage, database } from '../../configFirebase';\r\nimport { FaCloudUploadAlt } from 'react-icons/fa';\r\nimport {\r\n    AiFillCloseCircle,\r\n} from 'react-icons/ai';\r\nimport './style.css';\r\nimport { toast } from 'react-toastify';\r\nimport { IconContext } from 'react-icons/lib';\r\n\r\nUploadfiles.propTypes = {\r\n    toggleFormUpload: PropTypes.bool,\r\n    handleUploadSong: PropTypes.func,\r\n    handleToggleFormUpload: PropTypes.func,\r\n}\r\nUploadfiles.default = {\r\n    toggleFormUpload: false,\r\n    handleUploadSong: null,\r\n    handleToggleFormUpload: null\r\n}\r\n\r\nfunction Uploadfiles(props) {\r\n    const [fileAudio, setfileAudio] = useState(null);\r\n    const [fileImage, setfileImage] = useState(null);\r\n    const [urlAudio, setUrlAudio] = useState(null);\r\n    const [urlImage, setUrlImage] = useState(null);\r\n    const [progessAudio, setProgessAudio] = useState(null);\r\n    const [progessImage, setProgessImage] = useState(null);\r\n    const [artistName, setAristName] = useState('');\r\n    const [audioName, setAudioName] = useState('');\r\n    const { toggleFormUpload, handleUploadSong, handleToggleFormUpload } = props;\r\n    const handleChangeFiles = (e) => {\r\n        if (e.target.name === \"fileAudio\") {\r\n            setfileAudio(e.target.files[0])\r\n        }\r\n        if (e.target.name === \"fileImage\") {\r\n            setfileImage(e.target.files[0])\r\n        }\r\n    }\r\n    const handleChangeText = (e) => {\r\n        if (e.target.name === 'audioName') {\r\n            setAudioName(e.target.value);\r\n        } else {\r\n            setAristName(e.target.value);\r\n        }\r\n    }\r\n    const handleSaveAudio = () => {\r\n        if (fileAudio) {\r\n            const uploadTask = storage.ref(`Audios/${fileAudio.name}`).put(fileAudio);\r\n            uploadTask.on(\r\n                \"state_changed\",\r\n                (snapshot) => {\r\n                    const progressBarAudio = Math.round(\r\n                        (snapshot.bytesTransferred / snapshot.totalBytes) * 100\r\n                    );\r\n                    setProgessAudio(progressBarAudio);\r\n                },\r\n                error => {\r\n                    console.log('err', error);\r\n                },\r\n                () => {\r\n                    storage\r\n                        .ref(`Audios`)\r\n                        .child(fileAudio.name)\r\n                        .getDownloadURL()\r\n                        .then(urlAudio => {\r\n                            setUrlAudio(urlAudio);\r\n                        })\r\n                }\r\n            )\r\n        }\r\n        else {\r\n            toast('Chọn file bạn muốn up!', {\r\n                position: \"top-left\",\r\n                autoClose: 4000,\r\n                hideProgressBar: false,\r\n                closeOnClick: true,\r\n                pauseOnHover: true,\r\n                draggable: true,\r\n                progress: undefined\r\n            })\r\n        }\r\n    }\r\n    const handleSaveImage = () => {\r\n        if (fileImage) {\r\n            const uploadTask = storage.ref(`Images/${fileImage.name}`).put(fileImage);\r\n            uploadTask.on(\r\n                \"state_changed\",\r\n                (snapshot) => {\r\n                    const progressBarImage = Math.round(\r\n                        (snapshot.bytesTransferred / snapshot.totalBytes) * 100\r\n                    );\r\n                    setProgessImage(progressBarImage);\r\n                },\r\n                error => {\r\n                    console.log('err', error);\r\n                },\r\n                () => {\r\n                    storage\r\n                        .ref(`Images`)\r\n                        .child(fileImage.name)\r\n                        .getDownloadURL()\r\n                        .then(urlImage => {\r\n                            setUrlImage(urlImage);\r\n                        })\r\n                }\r\n            )\r\n        }\r\n        else {\r\n            toast('Chọn file bạn muốn up!', {\r\n                position: \"top-left\",\r\n                autoClose: 4000,\r\n                hideProgressBar: false,\r\n                closeOnClick: true,\r\n                pauseOnHover: true,\r\n                draggable: true,\r\n                progress: undefined\r\n            })\r\n        }\r\n    }\r\n    const onUploadDatabase = () => {\r\n        const databaseRef = database.ref('Audios');\r\n        if (fileAudio && fileImage) {\r\n            if (urlAudio && urlImage) {\r\n                if (audioName && artistName) {\r\n                    databaseRef.push({\r\n                        src: urlAudio,\r\n                        image: urlImage,\r\n                        name: audioName,\r\n                        artist: artistName\r\n                    })\r\n                    handleUploadSong({\r\n                        src: urlAudio,\r\n                        image: urlImage,\r\n                        name: audioName,\r\n                        artist: artistName\r\n                    })\r\n                    toast.success('Upload bài hát thành công!', {\r\n                        position: \"top-left\",\r\n                        autoClose: 4000,\r\n                        hideProgressBar: false,\r\n                        closeOnClick: true,\r\n                        pauseOnHover: true,\r\n                        draggable: true,\r\n                        progress: undefined\r\n                    })\r\n                    handleToggleFormUpload(false);\r\n                    // reset value\r\n                    setAristName('')\r\n                    setAudioName('')\r\n                    setProgessAudio(0)\r\n                    setProgessImage(0)\r\n                }\r\n                else {\r\n                    toast('Vui lòng nhập thông tin bài hát!', {\r\n                        position: \"top-left\",\r\n                        autoClose: 4000,\r\n                        hideProgressBar: false,\r\n                        closeOnClick: true,\r\n                        pauseOnHover: true,\r\n                        draggable: true,\r\n                        progress: undefined\r\n                    })\r\n                }\r\n            }\r\n            else {\r\n                toast('Tải file đã(hoặc chờ tải file)!', {\r\n                    position: \"top-left\",\r\n                    autoClose: 4000,\r\n                    hideProgressBar: false,\r\n                    closeOnClick: true,\r\n                    pauseOnHover: true,\r\n                    draggable: true,\r\n                    progress: undefined\r\n                })\r\n            }\r\n        } else {\r\n            toast('Vui lòng up file!', {\r\n                position: \"top-left\",\r\n                autoClose: 4000,\r\n                hideProgressBar: false,\r\n                closeOnClick: true,\r\n                pauseOnHover: true,\r\n                draggable: true,\r\n                progress: undefined,\r\n            }\r\n            );\r\n        }\r\n    }\r\n    const onToggleFormUpload = () => {\r\n        handleToggleFormUpload(false);\r\n    }\r\n    return (\r\n        <div className={`form-upload ${toggleFormUpload ? 'open' : ''}`}>\r\n            <div onClick={onToggleFormUpload}>\r\n                <IconContext.Provider value={{ className: \"files-close\", size: 30 }}>\r\n                    <AiFillCloseCircle />\r\n                </IconContext.Provider>\r\n            </div>\r\n            <p className=\"files-title\">Upload Files</p>\r\n            <div className=\"files-audio\">\r\n                <span className=\"files-name\">Audio</span>\r\n                <input\r\n                    type=\"file\"\r\n                    name=\"fileAudio\"\r\n                    accept=\".mp3\"\r\n                    className=\"files-input\"\r\n                    onChange={handleChangeFiles} />\r\n                <button\r\n                    className=\"files-button\"\r\n                    onClick={handleSaveAudio}\r\n                >\r\n                    <IconContext.Provider value={{ size: 20, color: '#ffffff' }}>\r\n                        <FaCloudUploadAlt />\r\n                    </IconContext.Provider>\r\n                </button>\r\n                <div className=\"progress\" style={{ height: '8px', }}>\r\n                    <div\r\n                        className=\"progress-bar progress-bar-striped \"\r\n                        role=\"progressbar\"\r\n                        aria-valuemin=\"0\"\r\n                        aria-valuemax=\"100\"\r\n                        style={{ width: `${progessAudio}%` }}>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div className=\"files-image\">\r\n                <span className=\"files-name\">Image</span>\r\n                <input\r\n                    accept=\".jpg\"\r\n                    type=\"file\"\r\n                    name=\"fileImage\"\r\n                    className=\"files-input\"\r\n                    onChange={handleChangeFiles} />\r\n                <button\r\n                    className=\"files-button\"\r\n                    onClick={handleSaveImage}\r\n                >\r\n                    <IconContext.Provider value={{ size: 20, color: '#ffffff' }}>\r\n                        <FaCloudUploadAlt />\r\n                    </IconContext.Provider>\r\n                </button>\r\n                <div className=\"progress\" style={{ height: '8px', Backgroundcolor: '#56184d' }}>\r\n                    <div\r\n                        style={{ backgroundColor: '#56184d' }}\r\n                        className=\"progress-bar progress-bar-striped\"\r\n                        role=\"progressbar\"\r\n                        aria-valuemin=\"0\"\r\n                        aria-valuemax=\"100\"\r\n                        style={{ width: `${progessImage}%` }}>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div className=\"wrapper-upload\">\r\n                <input\r\n                    placeholder=\"Artist Name\"\r\n                    name=\"artistName\"\r\n                    className=\"files-text\"\r\n                    value={artistName}\r\n                    onChange={handleChangeText}\r\n                    type=\"text\" />\r\n                <input\r\n                    placeholder=\"Audio Name\"\r\n                    onChange={handleChangeText}\r\n                    name=\"audioName\"\r\n                    value={audioName}\r\n                    className=\"files-text\"\r\n                    type=\"text\" />\r\n                <button\r\n                    className=\"files-button__upload\"\r\n                    onClick={onUploadDatabase}\r\n                >Lưu lại\r\n                </button>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default Uploadfiles;"]},"metadata":{},"sourceType":"module"}